#/usr/bin/env bash

# Modified version of [Sindre Sorhus's gist](https://gist.github.com/sindresorhus/6465739),
# to run the Guardian installation procedures after a `git pull`, if necessary.

changed_files="$(git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD)"

echo $changed_files | grep 'package.json' --quiet && npm prune && npm install
echo $changed_files | grep 'static/src/systemjs-config.js' --quiet && grunt shell:jspmInstallStatic
echo $changed_files | grep 'facia-tool/public/js/jspm-config.js' --quiet && grunt shell:jspmInstallFaciaTool
