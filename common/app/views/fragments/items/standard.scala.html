@(trail: model.Trail, index: Int, containerIndex: Int, element: String = "li", forceTone: Option[String] = None)(implicit request: RequestHeader, config: Config)

@import common.LinkTo
@import views.support.{GetClasses, RemoveOuterParaHtml, SnapData}

@defining((trail.visualTone, containerIndex == 0)) { case (tone, isFirstContainer) =>
    <@element
        class="@GetClasses.forItem(trail, isFirstContainer, forceTone = forceTone)"
        @if(trail.isCommentable) {
            @trail.discussionId.map{ id =>
                data-discussion-id="@id"
            }
            data-discussion-closed="@trail.isClosedForComments"
        }
        data-link-name="trail | @{index + 1}"
        @SnapData(trail)>

        <div class="item__container">
            <div class="item__tonal-border tone-accent-border"></div>
            @fragments.items.elements.image(trail, inlineImage = containerIndex == 0 && index < 4)
            <div class="item__header">
                @fragments.items.elements.title(trail, index, containerIndex, showTag = true)
                @trail match { case content:model.Content => @fragments.items.elements.starRating(content) }
            </div>

            @if(tone == "comment") {
                @trail.byline.map { byLine =>
                    @trail match { case content:model.Content =>
                        <p class="item__byline tone-colour">@ContributorLinks(Html(byLine), content.contributors)</p>
                    }
                }
            }

            @trail.trailText.map { text =>
                <div class="item__standfirst">@Html(text)</div>
            }

            @fragments.items.elements.meta(trail)
        </div>
        <a @LinkTo(trail).map{url=>href="@url"} class="u-faux-block-link__overlay" data-link-name="article" tabindex="-1">@RemoveOuterParaHtml(trail.headline)</a>
    </@element>
}
