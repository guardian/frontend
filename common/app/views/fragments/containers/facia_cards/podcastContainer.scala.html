@import model.FrontProperties
@(slice: layout.SliceWithCards, containerIndex: Int, frontProperties: Option[FrontProperties] = None, containerDisplayName: Option[String] = None, frontId: Option[String] = None)(implicit request: RequestHeader)

@import layout.{ColumnAndCards, SingleItem, Rows, SplitColumn, MPU}
@import views.html.fragments.items.facia_cards.item

@getAllCards = @{
    for {
        column <- slice.columns
        card <- column.cards
    } yield card
}

@getLatestEpisode(allCards: Seq[layout.FaciaCardAndIndex]) = @{
    allCards.collectFirst { case f @ layout.FaciaCardAndIndex(_, c: layout.ContentCard, _) if c.snapStuff.isEmpty => f }
}

@getSnapLink(allCards: Seq[layout.FaciaCardAndIndex]) = @{
    allCards.collectFirst { case f @ layout.FaciaCardAndIndex(_, c: layout.ContentCard, _) if c.snapStuff.nonEmpty => f }
}

<div class="fc-slice-wrapper">
    <ul class="u-unstyled l-row  l-row--cols-@slice.numberOfCols fc-slice fc-slice--@slice.cssClassName">
    @defining(getAllCards) { allCards =>
        @getLatestEpisode(allCards).map { card =>
            @item(card, containerIndex, frontProperties = frontProperties, containerDisplayName = containerDisplayName, frontId = frontId)
        }
        @getSnapLink(allCards).map { card =>
            @item(card, containerIndex, frontProperties = frontProperties, containerDisplayName = containerDisplayName, frontId = frontId)
        }
    }
    </ul>
</div>
