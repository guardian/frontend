/*
 * Swipe 1.0
 *
 * Brad Birdsall, Prime
 * Copyright 2011, Licensed GPL & MIT
 *
 * NOTE: this has been patched by MA to add enable/disable functionality
 *       this will need to be preserved / re-patched if we update this library
*/
!function(name,definition){if(typeof define=="function")define(definition);else if(typeof module!="undefined")module.exports=definition();else this[name]=definition()}("Swipe",function(){var Swipe=function(element,options){if(!element)return null;var _this=this;this.options=options||{};this.index=this.options.startSlide||0;this.speed=this.options.speed||300;this.callback=this.options.callback||function(){};this.delay=this.options.auto||0;this.isDisabled=false;this.container=element;this.element=this.container.children[0];
this.container.style.overflow="hidden";this.element.style.listStyle="none";this.setup();this.start();this.element.addEventListener("touchstart",this,false);this.element.addEventListener("touchmove",this,false);this.element.addEventListener("touchend",this,false);this.element.addEventListener("webkitTransitionEnd",this,false);this.element.addEventListener("msTransitionEnd",this,false);this.element.addEventListener("oTransitionEnd",this,false);this.element.addEventListener("transitionend",this,false);
window.addEventListener("resize",this,false)};Swipe.prototype={setup:function(){this.slides=this.element.children;this.length=this.slides.length;if(this.length<2)return null;this.container.style.visibility="hidden";this.width=this.container.getBoundingClientRect().width;this.element.style.width=this.slides.length*this.width+"px";var index=this.slides.length;while(index--){var el=this.slides[index];el.style.width=this.width+"px";el.style.display="table-cell";el.style.verticalAlign="top"}this.slide(this.index,
0,true);this.container.style.visibility="visible"},slide:function(index,duration,shouldNotDisable){if(!shouldNotDisable)shouldNotDisable=false;if(!shouldNotDisable)this.disable();var style=this.element.style;style.webkitTransitionDuration=style.MozTransitionDuration=style.msTransitionDuration=style.OTransitionDuration=style.transitionDuration=duration+"ms";style.webkitTransform="translate3d("+-(index*this.width)+"px,0,0)";style.msTransform=style.MozTransform=style.OTransform="translateX("+-(index*
this.width)+"px)";this.index=index},disable:function(){this.isDisabled=true},enable:function(){this.isDisabled=false},getPos:function(){return this.index},prev:function(delay){this.delay=delay||0;clearTimeout(this.interval);if(this.index)this.slide(this.index-1,this.speed)},next:function(delay){this.delay=delay||0;clearTimeout(this.interval);if(this.index<this.length-1)this.slide(this.index+1,this.speed);else this.slide(0,this.speed)},start:function(){var _this=this;this.interval=this.delay?setTimeout(function(){_this.next(_this.delay)},
this.delay):0},handleEvent:function(e){switch(e.type){case "touchstart":this.onTouchStart(e);break;case "touchmove":this.onTouchMove(e);break;case "touchend":this.onTouchEnd(e);break;case "webkitTransitionEnd":case "msTransitionEnd":case "oTransitionEnd":case "transitionend":this.transitionEnd(e);break;case "resize":this.setup();break}},transitionEnd:function(e){this.enable();if(this.delay)this.start();this.callback(e,this.index,this.slides[this.index])},onTouchStart:function(e){if(this.isDisabled)return false;
clearTimeout(this.interval);this.start={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY,time:Number(new Date)};this.isScrolling=undefined;this.deltaX=0;this.element.style.webkitTransitionDuration=0},onTouchMove:function(e){if(this.isDisabled)return false;this.deltaX=e.touches[0].pageX-this.start.pageX;if(typeof this.isScrolling=="undefined")this.isScrolling=!!(this.isScrolling||Math.abs(this.deltaX)<Math.abs(e.touches[0].pageY-this.start.pageY));if(!this.isScrolling){e.preventDefault();this.deltaX=
this.deltaX/(!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0?Math.abs(this.deltaX)/this.width+1:1);this.element.style.webkitTransform="translate3d("+(this.deltaX-this.index*this.width)+"px,0,0)"}},onTouchEnd:function(e){if(this.isDisabled)return false;var isValidSlide=Number(new Date)-this.start.time<250&&Math.abs(this.deltaX)>20||Math.abs(this.deltaX)>this.width/2,isPastBounds=!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0;if(!this.isScrolling)this.slide(this.index+
(isValidSlide&&!isPastBounds?this.deltaX<0?1:-1:0),this.speed)}};return Swipe});