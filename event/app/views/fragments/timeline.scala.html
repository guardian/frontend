@(story: Story)

@eventList(events: Seq[Event], isPanel: Boolean) = {
    <ul class="unstyled @if(isPanel){ panel}">
        @events.map { event =>
            <li class="trail event-block" data-link-name="trail">
                @defining(event.content.take(1).map(_.isLive).headOption.getOrElse(false)){ isLive =>
                    @fragments.relativeDate(event.startDate, isLive=isLive, isFront=true)
                }
                <div class="date-line">
                    <h3 class="type-5">@event.title</h3>
                </div>
                @if(event.hasContent) {
                <ul class="unstyled event-articles">
                    @event.content.map{ c =>
                    <li class="event-articles--item">
                        @fragments.relativeDate(c.webPublicationDate, false, false)
                        <p class="type-7">
                            <a href="@c.url">
                                @c.standfirst.map { s =>
                                    @withJsoup(BulletCleaner(s))(
                                        InBodyLinkCleaner("in standfirst link")
                                    )
                                }
                            </a>
                        </p>
                    </li>
                    }
                </ul>
                }
            </li>
        }
    </ul>
}

<div id="js-timeline" class="timeline box-indent expandable"
     data-count="@{story.events.size - 3}" data-link-name="Event timeline">
    @eventList(story.events.take(3), false)
    @eventList(story.events.drop(3), true)
</div>