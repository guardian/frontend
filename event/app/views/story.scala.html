@(page: StoryPage)(implicit request: RequestHeader)

@section(title: String, content: Seq[model.Content]) = {
    <li class="accordion-item">
        <a href="#" class="accordion-btn">@title <i class="i i-filter-arrow-right"></i></a>
        @fragments.section(title, content)
    </li>
}

@main(page, Switches.all){ }{

@defining(page.story){ story =>

    <h1 class="article-zone type-1">
        <span class="zone-color">@story.title</span>
    </h1>

    <section class="story-overview">
        @story.hero.map{ img =>
            <figure itemprop="associatedMedia primaryImageOfPage" itemscope itemtype="http://schema.org/ImageObject">
                <img class="maxed main-image" src="@story.hero"
                     itemprop="contentURL"
                     alt="@StripHtmlTags(story.title)"
                     title="@StripHtmlTags(story.title)" />
            </figure>
        }

        @story.explainer.map{ explainer =>
            <h2 class="page-head">Overview</h2>
            <p class="story-explainer box-indent from-content-api" itemprop="description" data-link-name="explainer">
                @cleanTrailText(explainer)
            </p>
        }
    </section>

    <ul class="accordion">

        @story.contentByColour.get("Background").map{ content => @section("Background", content) }
        @story.contentByColour.get("Analysis").map{ content => @section("Analysis", content) }
        @story.contentByColour.get("Reaction").map{ content => @section("Reaction", content) }

        @if(story.hasAgents) {
            <li class="accordion-item">
                <a href="#" class="accordion-btn">Key players <i class="i i-filter-arrow-right"></i></a>

                <section class="story-players">
                    <ul class="unstyled">
                    @story.agents.map { agent =>
                        @fragments.agent(agent)
                    }
                    </ul>
                </section>
            </li>
        }

        @if(story.hasEvents) {
            <li class="accordion-item">
                <a href="#" class="accordion-btn">Timeline of events <i class="i i-filter-arrow-right"></i></a>

                <section class="story-timeline">
                    @fragments.timeline(story)
                </section>
            </li>
        }
    </ul>
 }
}
