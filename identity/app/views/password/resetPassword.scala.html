@(page: model.Page, idRequest: services.IdentityRequest, idUrlBuilder: services.IdentityUrlBuilder, resetPasswordForm: Form[(String, String, String, Option[String])], token : String, returnUrl: String, isPaymentFailure: Boolean)(implicit request: RequestHeader, messages: play.api.i18n.Messages, context: model.ApplicationContext)

@import form.IdFormHelpers._
@import views.html.fragments.form.inputField
@import views.html.fragments.registrationFooter

    @emailAddress = @{ resetPasswordForm("email-address").value }

    <div class="identity-wrapper monocolumn-wrapper">
        <h1 class="identity-title">Please enter your new password for @emailAddress</h1>

        <form class="form" novalidate action="@idUrlBuilder.buildUrl(s"/reset-password/$token", idRequest)"  method="post">
            <input type="hidden" value="@emailAddress" name="email-address" />

            @if(resetPasswordForm.globalError.isDefined) {
                <div class="form__error">@resetPasswordForm.globalErrors.map(_.message).mkString(", ")</div>
            }

            <fieldset class="fieldset">
                <div class="fieldset__fields">
                    <ul class="u-unstyled">
                        <input type="hidden" name="returnUrl" value="@(returnUrl)">

                        @inputField(Password(resetPasswordForm("password"), '_label -> "New Password", '_help -> "Between 6 and 72 characters", 'autofocus -> true, 'class -> "js-register-password js-password-strength",
                        (Symbol("data-test-id"), "reset-new-password")))

                        @inputField(Password(resetPasswordForm("password-confirm"), '_label -> "Repeat password", (Symbol("data-test-id"), "reset-password-repeat")))

                        <li class="form-field">
                            <button type="submit" class="manage-account__button--icon manage-account__button manage-account__button--main" data-link-name="Save password" data-test-id="reset-pwd">
                                @if(isPaymentFailure) { Continue to update payment method } else { Save password }
                                @fragments.inlineSvg("arrow-right", "icon")
                            </button>
                        </li>
                    </ul>
                </div>
            </fieldset>
        </form>
    </div>
