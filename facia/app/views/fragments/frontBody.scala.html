@(faciaPage: model.FaciaPage)(implicit request: RequestHeader, templateDeduping: views.support.TemplateDeduping)

@import views.html.fragments.keywordList
@import views.support.MostPopularTags.topTags
@import views.support.RenderClasses

@if(faciaPage.collections.nonEmpty) {
    <div class="l-side-margins l-side-margins--layout-front">
        <div class="@RenderClasses(Map(
                "facia-container" -> true,
                "facia-container--layout-front" -> true,
                "facia-container--sponsored" -> faciaPage.isSponsored,
                "facia-container--advertisement-feature" -> faciaPage.isAdvertisementFeature,
                "facia-container--foundation-supported" -> faciaPage.isFoundationSupported,
                "js-sponsored-front" -> (faciaPage.isSponsored || faciaPage.isAdvertisementFeature || faciaPage.isFoundationSupported)))"
            data-link-name="Front | @request.path"
            @faciaPage.sponsor.map { sponsor =>
                data-sponsor="@sponsor"
            }
            @faciaPage.sponsorshipType.map { sponsorshipType =>
                data-sponsorship="@sponsorshipType"
            }
            role="main">

            @defining(faciaPage.collections.filter(_._2.items.nonEmpty)) { collections =>
                @collections.zipWithIndex.map{ case(block, index) =>
                    @fragments.frontCollection(faciaPage, (block._1.config, block._2), collections.size, index, block._1.id)
                }
            }

            <section class="facia-container__inner">
                @defining(topTags(faciaPage.allItems).take(20)) { tags =>
                    @if(tags.nonEmpty) {
                        <div class="submeta" data-link-name="keywords">
                            <h2 class="submeta__head">Trending topics</h2>
                            @keywordList(tags, 5, "See also")
                        </div>
                    }
                }
            </section>

        @if(!faciaPage.isAdvertisementFeature) {
            @fragments.commercial.commercialComponent()
        }
        </div>
    </div>
}
